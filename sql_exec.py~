import pyodbc
import sys

#connection_string = "DSN=so1web;UID=sof1;PWD=dbAdmin@so1"
connection_string = "SERVER=10.1.215.105;UID=phil;PWD=dbAdmin@so1;DRIVER={SQL Server}"
stored_proc_name = sys.argv[1]

connection = pyodbc.connect(connection_string, autocommit=True)
cursor = connection.cursor()

cursor.execute("exec %s" % stored_proc_name)
rows = cursor.fetchall()
cursor.close()

for row in rows:
    print ",".join(map(str,row))

sys.exit(0 if len(rows) == 0 else 1)
